<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>員工資料管理系統</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', 'Apple LiGothic Medium', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function EmployeeSurveyCRUD() {
            const [employees, setEmployees] = useState([]);
            const [currentView, setCurrentView] = useState('list');
            const [selectedEmployee, setSelectedEmployee] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [formData, setFormData] = useState({
                employeeId: '',
                name: '',
                department: '',
                position: '',
                gender: '',
                birthDate: '',
                hireDate: '',
                maritalStatus: '',
                children: [],
                nationality: '',
                education: '',
                certification: '',
                certificationOptions: [],
                certificationCustom: '',
                graduationMajor: '',
                graduationMajorOther: '',
                languageSkills: [],
                fixedLanguageSkills: {},
                travelWillingness: '',
                travelLocations: [],
                customTravelLocations: [],
                workLocation: '',
                healthInfo: '',
                healthInfoOptions: [],
                healthInfoCustom: '',
                mobile: '',
                email: '',
                address: '',
                residenceAddress: '',
                emergencyContactName: '',
                emergencyContactRelation: '',
                emergencyContactPhone: '',
                emergencyContactBackupPhone: '',
                lifeGoals: '',
                careerGoals: '',
                careerDevelopment: '',
                achievementProject: '',
                privacyConsent: false
            });

            useEffect(() => {
                const savedData = JSON.parse(localStorage.getItem('employeeData') || '[]');
                setEmployees(savedData);
            }, []);

            const saveToStorage = (data) => {
                localStorage.setItem('employeeData', JSON.stringify(data));
            };

            const resetForm = () => {
                setFormData({
                    employeeId: '',
                    name: '',
                    department: '',
                    position: '',
                    gender: '',
                    birthDate: '',
                    hireDate: '',
                    maritalStatus: '',
                    children: [],
                    nationality: '',
                    education: '',
                    certification: '',
                    certificationOptions: [],
                    certificationCustom: '',
                    graduationMajor: '',
                    graduationMajorOther: '',
                    languageSkills: [],
                    fixedLanguageSkills: {},
                    travelWillingness: '',
                    travelLocations: [],
                    customTravelLocations: [],
                    workLocation: '',
                    healthInfo: '',
                    healthInfoOptions: [],
                    healthInfoCustom: '',
                    mobile: '',
                    email: '',
                    address: '',
                    residenceAddress: '',
                    emergencyContactName: '',
                    emergencyContactRelation: '',
                    emergencyContactPhone: '',
                    emergencyContactBackupPhone: '',
                    lifeGoals: '',
                    careerGoals: '',
                    careerDevelopment: '',
                    achievementProject: '',
                    privacyConsent: false
                });
            };

            // 日期格式驗證函數
            const validateDateFormat = (date) => {
                if (!date) return false;
                
                // 支援 YYYY-MM-DD 格式（來自日期選擇器）
                if (date.includes('-')) {
                    const dateRegex = /^\d{4}-\d{2}-\d{2}$/;
                    if (!dateRegex.test(date)) return false;
                    
                    const [year, month, day] = date.split('-').map(num => parseInt(num));
                    
                    if (year < 1900 || year > new Date().getFullYear()) return false;
                    if (month < 1 || month > 12) return false;
                    if (day < 1 || day > 31) return false;
                    
                    // 檢查月份天數
                    const daysInMonth = new Date(year, month, 0).getDate();
                    return day <= daysInMonth;
                }
                
                // 支援 YYYYMMDD 格式
                const regex = /^\d{8}$/;
                if (!regex.test(date)) return false;
                
                const year = parseInt(date.substring(0, 4));
                const month = parseInt(date.substring(4, 6));
                const day = parseInt(date.substring(6, 8));
                
                if (year < 1900 || year > new Date().getFullYear()) return false;
                if (month < 1 || month > 12) return false;
                if (day < 1 || day > 31) return false;
                
                // 檢查月份天數
                const daysInMonth = new Date(year, month, 0).getDate();
                return day <= daysInMonth;
            };

            // 日期格式轉換函數
            const convertDateToYYYYMMDD = (date) => {
                if (!date) return '';
                if (date.includes('-')) {
                    // YYYY-MM-DD 轉 YYYYMMDD
                    return date.replace(/-/g, '');
                }
                return date; // 已經是 YYYYMMDD 格式
            };

            const convertDateToYYYY_MM_DD = (date) => {
                if (!date) return '';
                if (date.length === 8 && !date.includes('-')) {
                    // YYYYMMDD 轉 YYYY-MM-DD
                    return `${date.substring(0, 4)}-${date.substring(4, 6)}-${date.substring(6, 8)}`;
                }
                return date; // 已經是 YYYY-MM-DD 格式
            };

            // 表單驗證函數
            const validateForm = () => {
                const requiredFields = {
                    employeeId: '員編',
                    name: '姓名',
                    department: '部門',
                    position: '職務',
                    gender: '性別',
                    birthDate: '出生日期',
                    hireDate: '到職日',
                    maritalStatus: '婚姻狀況',
                    nationality: '身份別',
                    education: '學歷',
                    graduationMajor: '畢業科系',
                    travelWillingness: '國外派遣意願',
                    workLocation: '目前工作地點',
                    careerDevelopment: '職涯發展意向',
                    careerGoals: '個人的職涯目標',
                    lifeGoals: '個人的職涯目標',
                    achievementProject: '請分享您工作上最有成就感的工作表現(不僅限於目前目前公司)',
                    mobile: '手機電話',
                    email: '電子郵件',
                    address: '通訊地址',
                    residenceAddress: '戶籍地址',
                    emergencyContactName: '緊急聯絡人姓名',
                    emergencyContactRelation: '緊急聯絡人關係',
                    emergencyContactPhone: '緊急聯絡人電話'
                };

                // 檢查必填欄位
                for (const [field, label] of Object.entries(requiredFields)) {
                    if (!formData[field] || formData[field].toString().trim() === '') {
                        alert(`請填寫必填欄位：${label}`);
                        return false;
                    }
                }

                // 檢查個資同意
                if (!formData.privacyConsent) {
                    alert('請同意個資使用條款');
                    return false;
                }

                // 檢查日期格式
                if (!validateDateFormat(formData.birthDate)) {
                    alert('出生日期格式錯誤，請選擇正確的日期');
                    return false;
                }

                if (!validateDateFormat(formData.hireDate)) {
                    alert('到職日格式錯誤，請選擇正確的日期');
                    return false;
                }

                // 檢查其他科系是否填寫
                if (formData.graduationMajor === '其他' && (!formData.graduationMajorOther || formData.graduationMajorOther.trim() === '')) {
                    alert('請填寫具體的畢業科系');
                    return false;
                }

                // 檢查證照是否有選擇
                if ((!formData.certificationOptions || formData.certificationOptions.length === 0) && 
                    (!formData.certificationCustom || formData.certificationCustom.trim() === '')) {
                    alert('請選擇證照類型或填寫其他證照說明');
                    return false;
                }

                // 檢查語言能力是否有填寫
                const hasFixedLanguageSkill = formData.fixedLanguageSkills && 
                    Object.keys(formData.fixedLanguageSkills).length > 0 &&
                    Object.values(formData.fixedLanguageSkills).some(lang => 
                        lang && Object.values(lang).some(skill => skill && skill.trim() !== '')
                    );
                const hasCustomLanguageSkill = formData.languageSkills && 
                    formData.languageSkills.length > 0 &&
                    formData.languageSkills.some(skill => 
                        skill.language && skill.language.trim() !== '' &&
                        (skill.listening || skill.speaking || skill.reading || skill.writing)
                    );
                
                if (!hasFixedLanguageSkill && !hasCustomLanguageSkill) {
                    alert('請至少填寫一項語言能力（中文、英文或其他語言）');
                    return false;
                }

                return true;
            };

            const handleCreate = () => {
                if (!validateForm()) {
                    return;
                }
                
                if (employees.some(emp => emp.employeeId === formData.employeeId)) {
                    alert('員編已存在，請使用其他員編');
                    return;
                }

                // 轉換日期格式為 YYYYMMDD 後儲存
                const formDataToSave = {
                    ...formData,
                    birthDate: convertDateToYYYYMMDD(formData.birthDate),
                    hireDate: convertDateToYYYYMMDD(formData.hireDate),
                    id: Date.now().toString()
                };
                const newEmployee = formDataToSave;
                const updatedEmployees = [...employees, newEmployee];
                setEmployees(updatedEmployees);
                saveToStorage(updatedEmployees);
                resetForm();
                setCurrentView('list');
                alert('員工資料新增成功！');
            };

            const handleUpdate = () => {
                if (!validateForm()) {
                    return;
                }

                // 轉換日期格式為 YYYYMMDD 後更新
                const formDataToSave = {
                    ...formData,
                    birthDate: convertDateToYYYYMMDD(formData.birthDate),
                    hireDate: convertDateToYYYYMMDD(formData.hireDate),
                    id: selectedEmployee.id
                };
                const updatedEmployees = employees.map(emp => 
                    emp.id === selectedEmployee.id ? formDataToSave : emp
                );
                setEmployees(updatedEmployees);
                saveToStorage(updatedEmployees);
                resetForm();
                setCurrentView('list');
                setSelectedEmployee(null);
                alert('員工資料更新成功！');
            };

            const handleDelete = (employee) => {
                if (window.confirm(`確定要刪除 ${employee.name} 的資料嗎？`)) {
                    const updatedEmployees = employees.filter(emp => emp.id !== employee.id);
                    setEmployees(updatedEmployees);
                    saveToStorage(updatedEmployees);
                    alert('員工資料刪除成功！');
                }
            };

            const handleEdit = (employee) => {
                setSelectedEmployee(employee);
                setFormData({
                    ...employee,
                    // 轉換日期格式為 YYYY-MM-DD 供日期選擇器使用
                    birthDate: convertDateToYYYY_MM_DD(employee.birthDate || ''),
                    hireDate: convertDateToYYYY_MM_DD(employee.hireDate || ''),
                    children: employee.children || [],
                    languageSkills: employee.languageSkills || [],
                    fixedLanguageSkills: employee.fixedLanguageSkills || {},
                    travelLocations: employee.travelLocations || [],
                    customTravelLocations: employee.customTravelLocations || [],
                    careerDevelopment: employee.careerDevelopment || '',
                    achievementProject: employee.achievementProject || '',
                    healthInfoOptions: employee.healthInfoOptions || [],
                    healthInfoCustom: employee.healthInfoCustom || '',
                    certificationOptions: employee.certificationOptions || [],
                    certificationCustom: employee.certificationCustom || ''
                });
                setCurrentView('edit');
            };

            const filteredEmployees = employees.filter(emp => 
                emp.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                emp.employeeId.toLowerCase().includes(searchTerm.toLowerCase()) ||
                emp.department.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const handleInputChange = (field, value) => {
                setFormData(prev => ({
                    ...prev,
                    [field]: value
                }));
            };

            // 子女管理功能
            const addChild = () => {
                setFormData(prev => ({
                    ...prev,
                    children: [...prev.children, {
                        id: Date.now(),
                        age: ''
                    }]
                }));
            };

            const removeChild = (id) => {
                setFormData(prev => ({
                    ...prev,
                    children: prev.children.filter(child => child.id !== id)
                }));
            };

            const updateChild = (id, field, value) => {
                setFormData(prev => ({
                    ...prev,
                    children: prev.children.map(child =>
                        child.id === id ? { ...child, [field]: value } : child
                    )
                }));
            };

            // 語言技能管理功能 - 固定語言
            const updateFixedLanguageSkill = (language, field, value) => {
                setFormData(prev => ({
                    ...prev,
                    fixedLanguageSkills: {
                        ...prev.fixedLanguageSkills,
                        [language]: {
                            ...prev.fixedLanguageSkills?.[language],
                            [field]: value
                        }
                    }
                }));
            };

            // 語言技能管理功能 - 自訂語言
            const addLanguageSkill = () => {
                setFormData(prev => ({
                    ...prev,
                    languageSkills: [...prev.languageSkills, {
                        id: Date.now(),
                        language: '',
                        listening: '',
                        speaking: '',
                        reading: '',
                        writing: ''
                    }]
                }));
            };

            const removeLanguageSkill = (id) => {
                setFormData(prev => ({
                    ...prev,
                    languageSkills: prev.languageSkills.filter(skill => skill.id !== id)
                }));
            };

            const updateLanguageSkill = (id, field, value) => {
                setFormData(prev => ({
                    ...prev,
                    languageSkills: prev.languageSkills.map(skill =>
                        skill.id === id ? { ...skill, [field]: value } : skill
                    )
                }));
            };

            // 健康狀況管理功能
            const handleHealthInfoOptionChange = (option, checked) => {
                setFormData(prev => {
                    let newOptions;
                    
                    if (option === '無') {
                        // 如果選擇"無"，則清空其他所有選項，只保留"無"
                        if (checked) {
                            newOptions = ['無'];
                        } else {
                            newOptions = [];
                        }
                    } else {
                        // 如果選擇其他選項，先移除"無"（如果存在）
                        const filteredOptions = prev.healthInfoOptions.filter(opt => opt !== '無');
                        
                        if (checked) {
                            newOptions = [...filteredOptions, option];
                        } else {
                            newOptions = filteredOptions.filter(opt => opt !== option);
                        }
                    }
                    
                    // 更新 healthInfo 字段
                    let healthInfoText = '';
                    if (newOptions.length > 0) {
                        healthInfoText = newOptions.join(', ');
                        if (prev.healthInfoCustom && !newOptions.includes('無')) {
                            healthInfoText += ', ' + prev.healthInfoCustom;
                        }
                    } else if (prev.healthInfoCustom) {
                        healthInfoText = prev.healthInfoCustom;
                    }
                    
                    return {
                        ...prev,
                        healthInfoOptions: newOptions,
                        healthInfo: healthInfoText
                    };
                });
            };

            const updateHealthInfoCustom = (value) => {
                setFormData(prev => {
                    // 更新 healthInfo 字段
                    let healthInfoText = '';
                    if (prev.healthInfoOptions.length > 0) {
                        healthInfoText = prev.healthInfoOptions.join(', ');
                        // 只有在沒有選擇"無"的情況下才加入自訂內容
                        if (value && !prev.healthInfoOptions.includes('無')) {
                            healthInfoText += ', ' + value;
                        }
                    } else if (value) {
                        healthInfoText = value;
                    }
                    
                    return {
                        ...prev,
                        healthInfoCustom: value,
                        healthInfo: healthInfoText
                    };
                });
            };

            // 證照管理功能
            const handleCertificationOptionChange = (option, checked) => {
                setFormData(prev => {
                    let newOptions;
                    
                    if (option === '無') {
                        // 如果選擇"無"，則清空其他所有選項，只保留"無"
                        if (checked) {
                            newOptions = ['無'];
                        } else {
                            newOptions = [];
                        }
                    } else {
                        // 如果選擇其他選項，先移除"無"（如果存在）
                        const filteredOptions = prev.certificationOptions.filter(opt => opt !== '無');
                        
                        if (checked) {
                            newOptions = [...filteredOptions, option];
                        } else {
                            newOptions = filteredOptions.filter(opt => opt !== option);
                        }
                    }
                    
                    // 更新 certification 字段
                    let certificationText = '';
                    if (newOptions.length > 0) {
                        certificationText = newOptions.join(', ');
                        if (prev.certificationCustom && !newOptions.includes('無')) {
                            certificationText += ', ' + prev.certificationCustom;
                        }
                    } else if (prev.certificationCustom) {
                        certificationText = prev.certificationCustom;
                    }
                    
                    return {
                        ...prev,
                        certificationOptions: newOptions,
                        certification: certificationText
                    };
                });
            };

            const updateCertificationCustom = (value) => {
                setFormData(prev => {
                    // 更新 certification 字段
                    let certificationText = '';
                    if (prev.certificationOptions.length > 0) {
                        certificationText = prev.certificationOptions.join(', ');
                        // 只有在沒有選擇"無"的情況下才加入自訂內容
                        if (value && !prev.certificationOptions.includes('無')) {
                            certificationText += ', ' + value;
                        }
                    } else if (value) {
                        certificationText = value;
                    }
                    
                    return {
                        ...prev,
                        certificationCustom: value,
                        certification: certificationText
                    };
                });
            };

            // 國外派遣地點管理功能
            const handleTravelLocationChange = (location, checked) => {
                setFormData(prev => {
                    if (checked) {
                        // 新增地點
                        return {
                            ...prev,
                            travelLocations: [...prev.travelLocations, location]
                        };
                    } else {
                        // 移除地點
                        return {
                            ...prev,
                            travelLocations: prev.travelLocations.filter(loc => loc !== location)
                        };
                    }
                });
            };

            // 自訂國外派遣地點管理
            const addCustomTravelLocation = () => {
                setFormData(prev => ({
                    ...prev,
                    customTravelLocations: [...(prev.customTravelLocations || []), {
                        id: Date.now(),
                        location: ''
                    }]
                }));
            };

            const removeCustomTravelLocation = (id) => {
                setFormData(prev => ({
                    ...prev,
                    customTravelLocations: (prev.customTravelLocations || []).filter(location => location.id !== id)
                }));
            };

            const updateCustomTravelLocation = (id, value) => {
                setFormData(prev => ({
                    ...prev,
                    customTravelLocations: (prev.customTravelLocations || []).map(location =>
                        location.id === id ? { ...location, location: value } : location
                    )
                }));
            };

            const handleExportData = () => {
                if (employees.length === 0) {
                    alert('目前沒有員工資料可以匯出');
                    return;
                }

                const dataToExport = {
                    exportDate: new Date().toISOString(),
                    totalEmployees: employees.length,
                    employees: employees
                };

                const dataStr = JSON.stringify(dataToExport, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `員工資料_${new Date().toLocaleDateString('zh-TW').replace(/\//g, '-')}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                alert(`成功匯出 ${employees.length} 筆員工資料！`);
            };

            const handleImportData = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        if (!importedData.employees || !Array.isArray(importedData.employees)) {
                            alert('檔案格式不正確');
                            return;
                        }

                        if (window.confirm(`即將匯入 ${importedData.employees.length} 筆資料，是否繼續？`)) {
                            setEmployees(importedData.employees);
                            saveToStorage(importedData.employees);
                            alert(`成功匯入 ${importedData.employees.length} 筆員工資料！`);
                        }
                    } catch (error) {
                        alert('檔案讀取失敗');
                    }
                };
                reader.readAsText(file);
                event.target.value = '';
            };

            const clearAllData = () => {
                if (window.confirm('確定要清除所有資料嗎？此操作無法復原！')) {
                    localStorage.removeItem('employeeData');
                    setEmployees([]);
                    alert('所有員工資料已清除！');
                }
            };

            if (currentView === 'list') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                        <div className="max-w-7xl mx-auto space-y-6">
                            <div className="flex justify-between items-center bg-white rounded-lg shadow-lg p-6">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800 mb-2">員工資料管理系統</h1>
                                    <p className="text-gray-600">Version 8.0 - 專業版</p>
                                </div>
                                <div className="flex gap-3">
                                    <input
                                        type="file"
                                        accept=".json"
                                        onChange={handleImportData}
                                        style={{ display: 'none' }}
                                        id="import-file"
                                    />
                                    <label
                                        htmlFor="import-file"
                                        className="bg-emerald-600 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-emerald-700 transition-colors duration-200 flex items-center gap-2"
                                    >
                                        📁 匯入資料
                                    </label>
                                    <button
                                        onClick={handleExportData}
                                        className="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors duration-200 flex items-center gap-2"
                                    >
                                        💾 匯出資料
                                    </button>
                                    <button
                                        onClick={clearAllData}
                                        className="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 flex items-center gap-2"
                                    >
                                        🗑️ 清除資料
                                    </button>
                                    <button
                                        onClick={() => {
                                            resetForm();
                                            setCurrentView('create');
                                        }}
                                        className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center gap-2 font-semibold"
                                    >
                                        ➕ 新增員工
                                    </button>
                                </div>
                            </div>

                            <div className="bg-white rounded-lg shadow-lg p-6">
                                <div className="relative mb-4">
                                    <input
                                        type="text"
                                        placeholder="🔍 搜尋員編、姓名或部門..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                    />
                                </div>

                                <div className="bg-gray-50 rounded-lg p-4 mb-4">
                                    <div className="flex justify-between items-center text-sm text-gray-600">
                                        <span>總計員工數量：<span className="font-semibold text-blue-600">{employees.length}</span> 人</span>
                                        <span>搜尋結果：<span className="font-semibold text-green-600">{filteredEmployees.length}</span> 人</span>
                                    </div>
                                </div>

                                <div className="overflow-hidden rounded-lg border border-gray-200">
                                    <div className="overflow-x-auto">
                                        <table className="min-w-full divide-y divide-gray-200">
                                            <thead className="bg-gray-50">
                                                <tr>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">員編</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">姓名</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">部門</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">職務</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">畢業科系</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">子女</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">國外派遣地點</th>
                                                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody className="bg-white divide-y divide-gray-200">
                                                {filteredEmployees.map((employee, index) => (
                                                    <tr key={employee.id} className={`hover:bg-blue-50 transition-colors duration-150 ${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}`}>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{employee.employeeId}</td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium">{employee.name}</td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                                                            {employee.department && (
                                                                <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                                    {employee.department}
                                                                </span>
                                                            )}
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">{employee.position}</td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                                            {employee.graduationMajor ? (
                                                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                                    employee.graduationMajor === '文學相關' ? 'bg-pink-100 text-pink-800' :
                                                    employee.graduationMajor === '法律相關' ? 'bg-indigo-100 text-indigo-800' :
                                                    employee.graduationMajor === '商業相關' ? 'bg-green-100 text-green-800' :
                                                    employee.graduationMajor === '管理相關' ? 'bg-blue-100 text-blue-800' :
                                                    employee.graduationMajor === '化學相關' ? 'bg-orange-100 text-orange-800' :
                                                    employee.graduationMajor === '工程相關' ? 'bg-gray-100 text-gray-800' :
                                                    employee.graduationMajor === '資訊相關' ? 'bg-cyan-100 text-cyan-800' :
                                                    'bg-purple-100 text-purple-800'
                                                }`}>
                                                    {employee.graduationMajor === '其他' && employee.graduationMajorOther ? 
                                                        employee.graduationMajorOther : employee.graduationMajor}
                                                </span>
                                            ) : (
                                                <span className="text-gray-400 text-xs">未填寫</span>
                                            )}
                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                                                            {employee.children && employee.children.length > 0 ? (
                                                                <div className="space-y-1">
                                                                    {employee.children.map((child, idx) => (
                                                                        <span key={idx} className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 mr-1">
                                                                            {child.age}
                                                                        </span>
                                                                    ))}
                                                                </div>
                                                            ) : (
                                                                <span className="text-gray-400 text-xs">無</span>
                                                            )}
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                                                            {employee.travelWillingness ? (
                                                                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                                                    employee.travelWillingness === '願意' ? 'bg-green-100 text-green-800' :
                                                                    employee.travelWillingness === '視情況' ? 'bg-yellow-100 text-yellow-800' :
                                                                    'bg-red-100 text-red-800'
                                                                }`}>
                                                                    {employee.travelWillingness}
                                                                </span>
                                                            ) : (
                                                                <span className="text-gray-400 text-xs">未填寫</span>
                                                            )}
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                                            <button
                                                                onClick={() => handleEdit(employee)}
                                                                className="text-blue-600 hover:text-blue-900 hover:bg-blue-50 px-3 py-1 rounded transition-colors duration-150"
                                                            >
                                                                ✏️ 編輯
                                                            </button>
                                                            <button
                                                                onClick={() => handleDelete(employee)}
                                                                className="text-red-600 hover:text-red-900 hover:bg-red-50 px-3 py-1 rounded transition-colors duration-150"
                                                            >
                                                                🗑️ 刪除
                                                            </button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                    {filteredEmployees.length === 0 && (
                                        <div className="text-center py-12 text-gray-500">
                                            <div className="text-6xl mb-4">📋</div>
                                            <h3 className="text-lg font-medium mb-2">
                                                {searchTerm ? '找不到符合條件的員工資料' : '尚無員工資料'}
                                            </h3>
                                            <p className="text-sm">
                                                {searchTerm ? '請嘗試其他搜尋關鍵字' : '點擊上方「新增員工」按鈕開始建立資料'}
                                            </p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-7xl mx-auto space-y-6">
                        <div className="flex justify-between items-center bg-white rounded-lg shadow-lg p-6">
                            <div>
                                <h2 className="text-2xl font-bold text-gray-800">
                                    {currentView === 'create' ? '✨ 新增員工資料' : '✏️ 編輯員工資料'}
                                </h2>
                                <p className="text-gray-600 mt-1">請填寫完整的員工基本資料</p>
                            </div>
                            <button
                                onClick={() => {
                                    setCurrentView('list');
                                    resetForm();
                                    setSelectedEmployee(null);
                                }}
                                className="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors duration-200 flex items-center gap-2"
                            >
                                ❌ 取消
                            </button>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-8 space-y-10">
                            <div>
                                <h3 className="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3 border-b border-gray-200 pb-3">
                                    👤 一、個人基本資料
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">員編 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.employeeId}
                                            onChange={(e) => handleInputChange('employeeId', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                            placeholder="請輸入員工編號"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">姓名 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.name}
                                            onChange={(e) => handleInputChange('name', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                            placeholder="請輸入姓名"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">部門 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.department}
                                            onChange={(e) => handleInputChange('department', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇部門</option>
                                            <option value="總公司">總公司</option>
                                            <option value="總管理處">總管理處</option>
                                            <option value="製造部">製造部</option>
                                            <option value="儲運環安">儲運環安</option>
                                            <option value="塗開處">塗開處</option>
                                            <option value="品保部">品保部</option>
                                            <option value="鋼材台中">鋼材台中</option>
                                            <option value="鋼材台北">鋼材台北</option>
                                            <option value="鋼材高雄">鋼材高雄</option>
                                            <option value="混凝土處">混凝土處</option>
                                            <option value="特工處">特工處</option>
                                            <option value="製造官田">製造官田</option>
                                            <option value="官田預塗">官田預塗</option>
                                            <option value="中構官田">中構官田</option>
                                            <option value="柳營">柳營</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">職務 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.position}
                                            onChange={(e) => handleInputChange('position', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入職務"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">性別 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.gender}
                                            onChange={(e) => handleInputChange('gender', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="男">男</option>
                                            <option value="女">女</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">出生日期 <span className="text-red-500">*</span></label>
                                        <input
                                            type="date"
                                            value={formData.birthDate}
                                            onChange={(e) => handleInputChange('birthDate', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            min="1900-01-01"
                                            max={new Date().toISOString().split('T')[0]}
                                            required
                                        />
                                        <div className="text-xs text-gray-500 mt-1">⏰ 可選擇範圍：1900年至今天，系統將自動轉換為YYYYMMDD格式儲存</div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">到職日 <span className="text-red-500">*</span></label>
                                        <input
                                            type="date"
                                            value={formData.hireDate}
                                            onChange={(e) => handleInputChange('hireDate', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            min="1900-01-01"
                                            max={(() => {
                                                const today = new Date();
                                                const futureDate = new Date(today.getFullYear() + 1, today.getMonth(), today.getDate());
                                                return futureDate.toISOString().split('T')[0];
                                            })()}
                                            required
                                        />
                                        <div className="text-xs text-gray-500 mt-1">⏰ 可選擇範圍：1900年至明年今日，系統將自動轉換為YYYYMMDD格式儲存</div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">婚姻狀況 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.maritalStatus}
                                            onChange={(e) => handleInputChange('maritalStatus', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="已婚">已婚</option>
                                            <option value="未婚">未婚</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                </div>
                                
                                {/* 子女資料區塊 */}
                                <div className="mt-8">
                                    <div className="flex justify-between items-center mb-4">
                                        <label className="block text-sm font-medium text-gray-700">子女資料 (選填)</label>
                                        <button
                                            type="button"
                                            onClick={addChild}
                                            className="bg-green-600 text-white px-3 py-1 rounded-lg hover:bg-green-700 transition-colors duration-200 text-sm flex items-center gap-1"
                                        >
                                            ➕ 新增子女
                                        </button>
                                    </div>
                                    <div className="space-y-4">
                                        {formData.children.map((child) => (
                                            <div key={child.id} className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                                <div className="grid grid-cols-1 md:grid-cols-6 gap-3 items-center">
                                                    <div className="md:col-span-5">
                                                        <label className="block text-xs font-medium text-gray-600 mb-1">子女年齡</label>
                                                        <select
                                                            value={child.age}
                                                            onChange={(e) => updateChild(child.id, 'age', e.target.value)}
                                                            className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500"
                                                        >
                                                            <option value="">請選擇年齡</option>
                                                            <option value="7歲以下">7歲以下</option>
                                                            <option value="7-12歲">7-12歲</option>
                                                            <option value="13-18歲">13-18歲</option>
                                                            <option value="18歲以上">18歲以上</option>
                                                        </select>
                                                    </div>
                                                    <div className="md:col-span-1 flex justify-end">
                                                        <button
                                                            type="button"
                                                            onClick={() => removeChild(child.id)}
                                                            className="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition-colors duration-200 text-sm"
                                                        >
                                                            🗑️
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                        {formData.children.length === 0 && (
                                            <div className="text-center py-8 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
                                                <div className="text-4xl mb-2">👶</div>
                                                <p className="text-sm">尚未新增任何子女資料</p>
                                                <p className="text-xs mt-1">點擊上方「新增子女」按鈕開始新增</p>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">身份別 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.nationality}
                                            onChange={(e) => handleInputChange('nationality', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="本國">本國</option>
                                            <option value="外國">外國</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">學歷 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.education}
                                            onChange={(e) => handleInputChange('education', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="高中以下">高中以下</option>
                                            <option value="高中職">高中職</option>
                                            <option value="專科">專科</option>
                                            <option value="大學">大學</option>
                                            <option value="碩士">碩士</option>
                                            <option value="博士">博士</option>
                                        </select>
                                    </div>
                                </div>
                                
                                {/* 畢業科系區塊 */}
                                <div className="mt-6">
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium text-gray-700 mb-2">畢業科系 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.graduationMajor}
                                            onChange={(e) => handleInputChange('graduationMajor', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="文學相關">文學相關</option>
                                            <option value="法律相關">法律相關</option>
                                            <option value="商業相關">商業相關</option>
                                            <option value="管理相關">管理相關</option>
                                            <option value="化學相關">化學相關</option>
                                            <option value="工程相關">工程相關</option>
                                            <option value="資訊相關">資訊相關</option>
                                            <option value="其他">其他</option>
                                        </select>
                                        {formData.graduationMajor === '其他' && (
                                            <div className="mt-3">
                                                <label className="block text-sm font-medium text-gray-700 mb-2">請輸入具體科系 <span className="text-red-500">*</span></label>
                                                <input
                                                    type="text"
                                                    value={formData.graduationMajorOther}
                                                    onChange={(e) => handleInputChange('graduationMajorOther', e.target.value)}
                                                    className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                                    placeholder="請輸入您的畢業科系"
                                                    required
                                                />
                                            </div>
                                        )}
                                    </div>
                                </div>
                                
                                <div className="mt-6">
                                    <label className="block text-sm font-medium text-gray-700 mb-4">證照 <span className="text-red-500">*</span></label>
                                    
                                    {/* 固定證照選項 - 多選 */}
                                    <div className="bg-gray-50 rounded-lg p-4 border border-gray-200 mb-4">
                                        <div className="mb-3">
                                            <span className="text-sm font-medium text-gray-600">證照類型選項</span>
                                            <div className="text-xs text-gray-500 mt-1">💡 註：選擇"無"時為單選，不可同時選擇其他選項</div>
                                        </div>
                                        <div className="space-y-3">
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('無') || false}
                                                    onChange={(e) => handleCertificationOptionChange('無', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                />
                                                <span className="text-sm text-gray-700 font-medium">無</span>
                                                <span className="text-xs text-gray-400">(單選)</span>
                                            </label>
                                        </div>
                                        <div className="grid grid-cols-2 md:grid-cols-3 gap-3 mt-3">
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('勞工安全') || false}
                                                    onChange={(e) => handleCertificationOptionChange('勞工安全', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>勞工安全</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('有機溶劑') || false}
                                                    onChange={(e) => handleCertificationOptionChange('有機溶劑', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>有機溶劑</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('特定化學') || false}
                                                    onChange={(e) => handleCertificationOptionChange('特定化學', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>特定化學</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('急救人員') || false}
                                                    onChange={(e) => handleCertificationOptionChange('急救人員', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>急救人員</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('施工架作業') || false}
                                                    onChange={(e) => handleCertificationOptionChange('施工架作業', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>施工架作業</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('缺氧') || false}
                                                    onChange={(e) => handleCertificationOptionChange('缺氧', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>缺氧</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('粉塵') || false}
                                                    onChange={(e) => handleCertificationOptionChange('粉塵', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>粉塵</span>
                                            </label>
                                            <label className="flex items-center space-x-3 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.certificationOptions?.includes('高空工作車') || false}
                                                    onChange={(e) => handleCertificationOptionChange('高空工作車', e.target.checked)}
                                                    className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                    disabled={formData.certificationOptions?.includes('無')}
                                                />
                                                <span className={`text-sm ${formData.certificationOptions?.includes('無') ? 'text-gray-400' : 'text-gray-700'}`}>高空工作車</span>
                                            </label>
                                        </div>
                                    </div>

                                    {/* 其他證照自訂輸入 */}
                                    <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                        <div className="mb-3">
                                            <span className="text-sm font-medium text-gray-600">其他證照</span>
                                            {formData.certificationOptions?.includes('無') && (
                                                <div className="text-xs text-orange-600 mt-1">選擇"無"時不可填寫其他證照</div>
                                            )}
                                        </div>
                                        <textarea
                                            value={formData.certificationCustom || ''}
                                            onChange={(e) => updateCertificationCustom(e.target.value)}
                                            className={`w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 ${
                                                formData.certificationOptions?.includes('無') ? 'bg-gray-200 cursor-not-allowed' : ''
                                            }`}
                                            rows={3}
                                            placeholder={formData.certificationOptions?.includes('無') ? 
                                                "已選擇「無」，無法填寫其他證照" : 
                                                "如有其他證照，請在此詳細說明..."
                                            }
                                            disabled={formData.certificationOptions?.includes('無')}
                                        />
                                    </div>
                                </div>
                                
                                {/* 語言能力區塊 */}
                                <div className="mt-8">
                                    <label className="block text-sm font-medium text-gray-700 mb-4">語言能力 <span className="text-red-500">*</span></label>
                                    
                                    {/* 固定語言選項 */}
                                    <div className="bg-gray-50 rounded-lg p-4 border border-gray-200 mb-4">
                                        <div className="mb-3">
                                            <span className="text-xs font-medium text-gray-600">固定語言選項</span>
                                        </div>
                                        <div className="space-y-4">
                                            {['中文', '英文'].map((language) => (
                                                <div key={language} className="border border-gray-200 rounded-lg p-3 bg-white">
                                                    <div className="grid grid-cols-1 md:grid-cols-6 gap-3 items-center">
                                                        <div className="md:col-span-2">
                                                            <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${
                                                                language === '中文' ? 'bg-red-100 text-red-800' :
                                                                language === '英文' ? 'bg-blue-100 text-blue-800' :
                                                                'bg-yellow-100 text-yellow-800'
                                                            }`}>
                                                                {language}
                                                            </span>
                                                        </div>
                                                        <div className="md:col-span-4">
                                                            <div className="grid grid-cols-2 gap-2">
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">聽</label>
                                                                    <select
                                                                        value={formData.fixedLanguageSkills?.[language]?.listening || ''}
                                                                        onChange={(e) => updateFixedLanguageSkill(language, 'listening', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">說</label>
                                                                    <select
                                                                        value={formData.fixedLanguageSkills?.[language]?.speaking || ''}
                                                                        onChange={(e) => updateFixedLanguageSkill(language, 'speaking', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">讀</label>
                                                                    <select
                                                                        value={formData.fixedLanguageSkills?.[language]?.reading || ''}
                                                                        onChange={(e) => updateFixedLanguageSkill(language, 'reading', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">寫</label>
                                                                    <select
                                                                        value={formData.fixedLanguageSkills?.[language]?.writing || ''}
                                                                        onChange={(e) => updateFixedLanguageSkill(language, 'writing', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    {/* 其他自訂語言 */}
                                    <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                        <div className="flex justify-between items-center mb-3">
                                            <span className="text-xs font-medium text-gray-600">其他語言</span>
                                            <button
                                                type="button"
                                                onClick={addLanguageSkill}
                                                className="bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700 transition-colors duration-200 flex items-center gap-1"
                                            >
                                                ➕ 新增語言
                                            </button>
                                        </div>
                                        <div className="space-y-4">
                                            {formData.languageSkills.map((skill) => (
                                                <div key={skill.id} className="border border-gray-200 rounded-lg p-3 bg-white">
                                                    <div className="grid grid-cols-1 md:grid-cols-6 gap-3 items-center">
                                                        <div className="md:col-span-2">
                                                            <label className="block text-xs font-medium text-gray-600 mb-1">語言名稱</label>
                                                            <input
                                                                type="text"
                                                                value={skill.language}
                                                                onChange={(e) => updateLanguageSkill(skill.id, 'language', e.target.value)}
                                                                placeholder="請輸入語言名稱"
                                                                className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500"
                                                            />
                                                        </div>
                                                        <div className="md:col-span-3">
                                                            <label className="block text-xs font-medium text-gray-600 mb-1">能力程度</label>
                                                            <div className="grid grid-cols-2 gap-2">
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">聽</label>
                                                                    <select
                                                                        value={skill.listening}
                                                                        onChange={(e) => updateLanguageSkill(skill.id, 'listening', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">說</label>
                                                                    <select
                                                                        value={skill.speaking}
                                                                        onChange={(e) => updateLanguageSkill(skill.id, 'speaking', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">讀</label>
                                                                    <select
                                                                        value={skill.reading}
                                                                        onChange={(e) => updateLanguageSkill(skill.id, 'reading', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                                <div>
                                                                    <label className="block text-xs text-gray-500 mb-1">寫</label>
                                                                    <select
                                                                        value={skill.writing}
                                                                        onChange={(e) => updateLanguageSkill(skill.id, 'writing', e.target.value)}
                                                                        className="w-full border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"
                                                                    >
                                                                        <option value="">請選擇</option>
                                                                        <option value="略懂">略懂</option>
                                                                        <option value="中等">中等</option>
                                                                        <option value="精通">精通</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="md:col-span-1 flex justify-end">
                                                            <button
                                                                type="button"
                                                                onClick={() => removeLanguageSkill(skill.id)}
                                                                className="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition-colors duration-200 text-sm"
                                                            >
                                                                🗑️
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                            {formData.languageSkills.length === 0 && (
                                                <div className="text-center py-4 text-gray-400 text-xs">
                                                    <div className="text-2xl mb-1">🗣️</div>
                                                    <p>尚未新增其他語言</p>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 className="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3 border-b border-gray-200 pb-3">
                                    💼 二、國外派遣意願
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">國外派遣意願 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.travelWillingness}
                                            onChange={(e) => handleInputChange('travelWillingness', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="願意">願意</option>
                                            <option value="視情況">視情況</option>
                                            <option value="無法">無法</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">目前工作地點 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.workLocation}
                                            onChange={(e) => handleInputChange('workLocation', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入目前工作地點"
                                            required
                                        />
                                    </div>
                                    
                                    {/* 外派地點選擇 - 只有在國外派遣意願不是「無法」時才顯示 */}
                                    {formData.travelWillingness && formData.travelWillingness !== '無法' && (
                                        <div className="md:col-span-2">
                                            <label className="block text-sm font-medium text-gray-700 mb-3">國外派遣地點選擇 (可多選)</label>
                                            
                                            {/* 固定選項 */}
                                            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200 mb-4">
                                                <div className="mb-2">
                                                    <span className="text-xs font-medium text-gray-600">固定選項</span>
                                                </div>
                                                <div className="space-y-3">
                                                    <label className="flex items-center space-x-3 cursor-pointer">
                                                        <input
                                                            type="checkbox"
                                                            checked={formData.travelLocations.includes('中國')}
                                                            onChange={(e) => handleTravelLocationChange('中國', e.target.checked)}
                                                            className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                        />
                                                        <span className="text-sm text-gray-700 font-medium">中國</span>
                                                    </label>
                                                    <label className="flex items-center space-x-3 cursor-pointer">
                                                        <input
                                                            type="checkbox"
                                                            checked={formData.travelLocations.includes('越南')}
                                                            onChange={(e) => handleTravelLocationChange('越南', e.target.checked)}
                                                            className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                                        />
                                                        <span className="text-sm text-gray-700 font-medium">越南</span>
                                                    </label>
                                                </div>
                                            </div>

                                            {/* 其他自訂選項 */}
                                            <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                                <div className="flex justify-between items-center mb-3">
                                                    <span className="text-xs font-medium text-gray-600">其他地點</span>
                                                    <button
                                                        type="button"
                                                        onClick={addCustomTravelLocation}
                                                        className="bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700 transition-colors duration-200 flex items-center gap-1"
                                                    >
                                                        ➕ 新增
                                                    </button>
                                                </div>
                                                <div className="space-y-3">
                                                    {(formData.customTravelLocations || []).map((customLocation) => (
                                                        <div key={customLocation.id} className="flex items-center space-x-2">
                                                            <input
                                                                type="text"
                                                                value={customLocation.location}
                                                                onChange={(e) => updateCustomTravelLocation(customLocation.id, e.target.value)}
                                                                placeholder="請輸入其他國外派遣地點"
                                                                className="flex-1 border border-gray-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500"
                                                            />
                                                            <button
                                                                type="button"
                                                                onClick={() => removeCustomTravelLocation(customLocation.id)}
                                                                className="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 transition-colors duration-200 text-xs"
                                                            >
                                                                🗑️
                                                            </button>
                                                        </div>
                                                    ))}
                                                    {(!formData.customTravelLocations || formData.customTravelLocations.length === 0) && (
                                                        <div className="text-center py-4 text-gray-400 text-xs">
                                                            <div className="text-2xl mb-1">🌍</div>
                                                            <p>尚未新增其他地點</p>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                            
                                            <div className="mt-3 text-xs text-gray-500">
                                                💡 可選擇固定選項或自行新增其他國外派遣地點
                                            </div>
                                        </div>
                                    )}

                                    {/* 當選擇「無法」國外派遣時顯示提示訊息 */}
                                    {formData.travelWillingness === '無法' && (
                                        <div className="md:col-span-2">
                                            <div className="bg-gray-100 rounded-lg p-4 border border-gray-300">
                                                <div className="flex items-center gap-3 text-gray-600">
                                                    <div className="text-2xl">ℹ️</div>
                                                    <div>
                                                        <p className="text-sm font-medium">您選擇了「無法」國外派遣</p>
                                                        <p className="text-xs text-gray-500 mt-1">因此無需選擇國外派遣地點</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            <div>
                                <h3 className="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3 border-b border-gray-200 pb-3">
                                    🎯 三、職涯規劃
                                </h3>
                                <div className="space-y-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">職涯發展意向 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.careerDevelopment}
                                            onChange={(e) => handleInputChange('careerDevelopment', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="不擅管理，喜專注自己工作範疇">不擅管理，喜專注自己工作範疇</option>
                                            <option value="喜歡管理職，希望帶領團隊">喜歡管理職，希望帶領團隊</option>
                                            <option value="喜歡技術職，希望鑽研專業領域">喜歡技術職，希望鑽研專業領域</option>
                                            <option value="管理技術職兩者皆可，保持開放">管理技術職兩者皆可，保持開放</option>
                                            <option value="尚無明確想法">尚無明確想法</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">個人的職涯目標 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.careerGoals}
                                            onChange={(e) => handleInputChange('careerGoals', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="成為管理人才">成為管理人才</option>
                                            <option value="成為專職人員(有證照)">成為專職人員(有證照)</option>
                                            <option value="成為專職人員(無證照)">成為專職人員(無證照)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">個人職涯目標與願景 <span className="text-red-500">*</span></label>
                                        <textarea
                                            value={formData.lifeGoals}
                                            onChange={(e) => handleInputChange('lifeGoals', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            rows={4}
                                            placeholder="請分享您的個人職涯目標與願景..."
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">請分享您工作上最有成就感的工作表現(不僅限於目前目前公司) <span className="text-red-500">*</span></label>
                                        <div className="text-xs text-gray-500 mb-3 bg-blue-50 p-3 rounded-lg">
                                            💡 請描述專案名稱、您的角色與具體貢獻，讓我們更了解您的工作成就
                                        </div>
                                        <textarea
                                            value={formData.achievementProject}
                                            onChange={(e) => handleInputChange('achievementProject', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            rows={5}
                                            placeholder="例如：&#10;專案名稱：客戶關係管理系統開發&#10;我的角色：前端開發工程師&#10;具體貢獻：負責使用者介面設計與開發，將系統使用便利性提升30%，獲得客戶高度好評..."
                                            required
                                        />
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 className="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3 border-b border-gray-200 pb-3">
                                    📞 四、聯絡資訊
                                </h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">手機電話 <span className="text-red-500">*</span></label>
                                        <input
                                            type="tel"
                                            value={formData.mobile}
                                            onChange={(e) => handleInputChange('mobile', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入手機號碼"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">電子郵件 <span className="text-red-500">*</span></label>
                                        <input
                                            type="email"
                                            value={formData.email}
                                            onChange={(e) => handleInputChange('email', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入電子郵件"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">通訊地址 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.address}
                                            onChange={(e) => handleInputChange('address', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入通訊地址"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">戶籍地址 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.residenceAddress}
                                            onChange={(e) => handleInputChange('residenceAddress', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入戶籍地址"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">緊急聯絡人姓名 <span className="text-red-500">*</span></label>
                                        <input
                                            type="text"
                                            value={formData.emergencyContactName}
                                            onChange={(e) => handleInputChange('emergencyContactName', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入緊急聯絡人姓名"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">緊急聯絡人關係 <span className="text-red-500">*</span></label>
                                        <select
                                            value={formData.emergencyContactRelation}
                                            onChange={(e) => handleInputChange('emergencyContactRelation', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            required
                                        >
                                            <option value="">請選擇</option>
                                            <option value="配偶">配偶</option>
                                            <option value="父母">父母</option>
                                            <option value="子女">子女</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">緊急聯絡人電話 <span className="text-red-500">*</span></label>
                                        <input
                                            type="tel"
                                            value={formData.emergencyContactPhone}
                                            onChange={(e) => handleInputChange('emergencyContactPhone', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入緊急聯絡人電話"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">緊急聯絡人備用電話</label>
                                        <input
                                            type="tel"
                                            value={formData.emergencyContactBackupPhone}
                                            onChange={(e) => handleInputChange('emergencyContactBackupPhone', e.target.value)}
                                            className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                            placeholder="請輸入備用電話（選填）"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 className="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3 border-b border-gray-200 pb-3">
                                    🛡️ 五、個資告知與同意
                                </h3>
                                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200">
                                    <label className="flex items-start gap-4 cursor-pointer">
                                        <input
                                            type="checkbox"
                                            checked={formData.privacyConsent}
                                            onChange={(e) => handleInputChange('privacyConsent', e.target.checked)}
                                            className="mt-1 h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded transition-all duration-200"
                                            required
                                        />
                                        <div>
                                            <span className="text-sm text-gray-700 leading-relaxed">
                                                本人已知悉並同意公司依個人資料保護法蒐集、處理及利用上述資料，僅供人事管理與福利用途。
                                            </span>
                                            <div className="mt-2">
                                                <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                                    必填 *
                                                </span>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div className="flex justify-end space-x-4 pt-6 border-t border-gray-200">
                                <button
                                    onClick={() => {
                                        setCurrentView('list');
                                        resetForm();
                                        setSelectedEmployee(null);
                                    }}
                                    className="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition-colors duration-200 flex items-center gap-2"
                                >
                                    ❌ 取消
                                </button>
                                <button
                                    onClick={currentView === 'create' ? handleCreate : handleUpdate}
                                    className="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-8 py-3 rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 flex items-center gap-2 font-semibold shadow-lg"
                                >
                                    💾 {currentView === 'create' ? '新增員工' : '更新資料'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<EmployeeSurveyCRUD />, document.getElementById('root'));
    </script>
</body>
</html>
                                            
